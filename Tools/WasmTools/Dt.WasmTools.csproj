<Project Sdk="Microsoft.NET.Sdk">

	<PropertyGroup>
		<TargetFramework>netstandard2.0</TargetFramework>
		<LangVersion>9.0</LangVersion>
		<NoWarn>NU5128</NoWarn>
		<!-- 打包时dll放在tools目录 -->
		<IsTool>true</IsTool>
		<!-- 打包时包含pdb文件，用于调试 -->
		<AllowedOutputExtensionsInPackageBuildOutputFolder Condition="'$(Configuration)'=='Debug'">$(AllowedOutputExtensionsInPackageBuildOutputFolder);.pdb</AllowedOutputExtensionsInPackageBuildOutputFolder>
		<GeneratePackageOnBuild Condition="'$(Configuration)'=='Release'">true</GeneratePackageOnBuild>
	</PropertyGroup>

	<!-- 包公共属性 -->
	<PropertyGroup>
		<Version>1.3.0</Version>
		<Description>搬运工wasm客户端工具包</Description>
		<Authors>Daoting</Authors>
		<Product>搬运工基础平台</Product>
		<Copyright>Copyright © 2021</Copyright>
		<PackageProjectUrl>https://github.com/daoting/dt</PackageProjectUrl>
		<PackageIcon>logo.png</PackageIcon>
		<PackageIconUrl />
		<PackageTags>搬运工 WinUI UWP Uno Wasm</PackageTags>
	</PropertyGroup>
	
	<!-- 包图标 -->
	<ItemGroup>
		<None Include="..\..\logo.png">
			<Pack>True</Pack>
			<PackagePath>\</PackagePath>
		</None>
	</ItemGroup>
	
	<ItemGroup>
		<EmbeddedResource Include="Res\service-worker.js" />
	</ItemGroup>

	<ItemGroup>
		<PackageReference Include="Microsoft.Build.Utilities.Core" Version="15.3.409" PrivateAssets="All" />
		<PackageReference Include="BrotliSharpLib" Version="0.3.3" IncludeAssets="all" PrivateAssets="All" />
		<!-- 为项目添加 TypeScript 编译支持，打包时注释掉，否则包内多出js文件 -->
		<!--<PackageReference Include="Microsoft.TypeScript.MSBuild" Version="4.8.4" PrivateAssets="All" />-->
	</ItemGroup>

	<!-- TypeScript参数，不使用tsconfig.json -->
	<PropertyGroup>
		<!-- 指定编译的ES版本 -->
		<TypeScriptTarget>ES2020</TypeScriptTarget>
		<!-- 保存后不立即编译 -->
		<TypeScriptCompileOnSaveEnabled>False</TypeScriptCompileOnSaveEnabled>
		<!-- 不允许隐式的any类型 -->
		<TypeScriptNoImplicitAny>True</TypeScriptNoImplicitAny>
		<!-- 如果报告了任何类型检查错误，则禁用输出文件 -->
		<TypeScriptNoEmitOnError>True</TypeScriptNoEmitOnError>
		<!-- 移除注释 -->
		<TypeScriptRemoveComments>True</TypeScriptRemoveComments>
		<!-- 合并输出文件 -->
		<TypeScriptOutFile>build/embedded/scripts/dt.js</TypeScriptOutFile>
		<!-- 不输出map文件 -->
		<TypeScriptSourceMap>False</TypeScriptSourceMap>
		<!-- ts文件根目录 -->
		<TypeScriptInclude>TypeScript/**/*</TypeScriptInclude>
	</PropertyGroup>
	
	<ItemGroup>
		<Content Include="build/**">
			<Pack>true</Pack>
			<PackagePath>build</PackagePath>
		</Content>
		<Content Include="$(NuGetPackageRoot)/brotlisharplib/0.3.3/lib/netstandard2.0/*.dll">
			<Pack>true</Pack>
			<PackagePath>tools</PackagePath>
			<CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
			<Visible>false</Visible>
		</Content>
	</ItemGroup>

</Project>
